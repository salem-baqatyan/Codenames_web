<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Codenames Pro - Lobby</title>
    <style>
        :root {
            --bg-dark: #000000;
            --panel-bg: #1a1a1a;
            --blue-team: #3498db;
            --red-team: #e74c3c;
            --green-action: #4caf50;
            --text-gray: #aaaaaa;
            --modal-bg: #2a2a2a;
        }
        * { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        body { 
            margin: 0; 
            background-color: var(--bg-dark); 
            color: white; 
            display: flex; 
            justify-content: center; 
            height: 100vh; 
            overflow: hidden; 
        }

        .mobile-wrapper {
            width: 100%; 
            max-width: 450px; 
            height: 100vh; 
            background: #000;
            display: flex; 
            flex-direction: column; 
            border-left: 1px solid #333; 
            border-right: 1px solid #333;
            position: relative;
        }

        /* ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø´Ø§Ø´Ø© */
        .top-section { height: 50vh; display: flex; flex-direction: column; padding-bottom: 5px; }
        .bottom-section { height: 50vh; display: flex; flex-direction: column; border-top: 1px solid #222; }
        /* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± (Scrollbar) Ù„ÙƒÙ„ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª */
        .settings-modal::-webkit-scrollbar {
            width: 5px; /* Ø¬Ø¹Ù„ Ø§Ù„Ø´Ø±ÙŠØ· Ù†Ø­ÙŠÙ Ø¬Ø¯Ø§Ù‹ */
        }

        .settings-modal::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2); /* Ø®Ù„ÙÙŠØ© Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ± */
            border-radius: 10px;
        }

        .settings-modal::-webkit-scrollbar-thumb {
            background: var(--green-action); /* Ù„ÙˆÙ† Ø§Ù„Ù…Ù‚Ø¨Ø¶ Ù†ÙØ³ Ù„ÙˆÙ† Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø®Ø¶Ø± */
            border-radius: 10px;
        }

        /* Ù„Ù…Ù†Ø¹ Ø§Ù„Ø³ÙƒØ±ÙˆÙ„ Ù…Ù† Ø§Ù„Ø¸Ù‡ÙˆØ± Ø¨Ø´ÙƒÙ„ Ù…ÙØ§Ø¬Ø¦ ÙˆØªØºÙŠÙŠØ± Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© */
        .settings-modal {
            scrollbar-gutter: stable;
            padding-right: 10px; /* Ù…Ø³Ø§Ø­Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ø¹ÙŠÙ† */
        }

        /* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ù€ Accordion Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„Ø³ÙƒØ±ÙˆÙ„ Ø§Ù„Ø·ÙˆÙŠÙ„ */
        .accordion-content {
            max-height: 300px; /* ØªØ­Ø¯ÙŠØ¯ Ø£Ù‚ØµÙ‰ Ø§Ø±ØªÙØ§Ø¹ Ù„Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© */
            overflow-y: auto;
        }
.top-bar { 
    display: flex; 
    justify-content: space-between; /* ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨ÙŠÙ† Ø§Ù„ÙŠÙ…ÙŠÙ† ÙˆØ§Ù„ÙŠØ³Ø§Ø± */
    align-items: center; 
    padding: 10px 15px; 
    flex-shrink: 0; 
}

.top-left {
    display: flex;
    align-items: center;
}

.top-right { 
    display: flex; 
    flex-direction: row; /* Ø¬Ø¹Ù„Ù‡Ù… Ø¨Ø¬Ø§Ù†Ø¨ Ø¨Ø¹Ø¶ */
    gap: 8px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    align-items: center; 
}
        .icon-circle {
            width: 40px; height: 40px; background: rgba(255,255,255,0.1);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            border: 0.5px solid white; cursor: pointer;
        }

.btn-pill {
    background: rgba(255,255,255,0.1); 
    border: 1px solid #444;
    padding: 6px 12px; 
    border-radius: 20px; 
    font-size: 0.75rem;
    display: flex; 
    align-items: center; 
    gap: 5px; 
    cursor: pointer;
    margin-bottom: 0; /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ø§Ù…Ø´ Ø§Ù„Ø³ÙÙ„ÙŠ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø³ØªÙ‚Ø§Ù…Ø© */
}

        .spectators-section { display: flex; flex-direction: column; align-items: center; gap: 5px; padding: 0 15px; flex-shrink: 0; }
        .spectators-list { display: flex; gap: 10px; justify-content: center; align-items: center; min-height: 65px; }

        .settings-panel {
            background: #1a1a1a; margin: 5px 15px; border-radius: 15px;
            padding: 10px; flex: 1; display: flex; flex-direction: column; justify-content: center;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }

        .panel-label { text-align: center; color: #888; font-size: 0.65rem; font-weight: bold; margin-bottom: 15px; }

        .mode-options { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .mode-card {
            background: #252525; border-radius: 10px; padding: 6px;
            display: flex; align-items: center; gap: 8px; border: 2px solid transparent; cursor: pointer;
            transition: 0.3s;
        }
        .mode-card.active { border-color: #3498db; background: #1e3a5f; }
        .mode-img { width: 30px; height: 40px; border-radius: 4px; pointer-events: none; }
        .mode-info { pointer-events: none; }
        .mode-info b { font-size: 0.65rem; display: block; }
        .mode-info span { font-size: 0.55rem; color: #aaa; }

        .setting-row {
            background: rgba(255,255,255,0.05); border-radius: 10px;
            margin-top: 8px; display: flex; align-items: center;
            padding: 6px 12px; border: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
        }

        .teams-grid { flex: 1; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 6px; padding: 10px 15px; }
        .team-box { border-radius: 15px; display: flex; flex-direction: column; justify-content: space-around; align-items: center; padding: 8px; border: 1.5px solid rgba(255, 255, 255, 0.3); }
        .blue-box { background: linear-gradient(135deg, #1e3a5f 0%, #3498db 100%); }
        .red-box { background: linear-gradient(135deg, #7b241c 0%, #e74c3c 100%); }
        .box-title { font-size: 0.6rem; font-weight: 800; color: white; letter-spacing: 1px; }

        .player-slot-container { min-height: 55px; display: flex; align-items: center; justify-content: center; }
        .join-btn {
            width: 85%; padding: 4px 0; font-size: 0.65rem; font-weight: bold;
            color: white; background: linear-gradient(to bottom, #7ed321, #417505);
            border: 1.5px solid #b8e986; border-radius: 15px; cursor: pointer;
            box-shadow: 0 2px 0 #2e5a03;
        }

        .player-slot { display: flex; flex-direction: column; align-items: center; }
        .player-avatar-wrap { width: 40px; height: 40px; position: relative; }
        .player-img { width: 100%; height: 100%; border-radius: 50%; border: 2px solid #fff; background: #333; }
        .player-name { background: rgba(0,0,0,0.7); font-size: 0.6rem; padding: 1px 6px; border-radius: 5px; margin-top: -5px; z-index: 2; }

        .footer { padding: 10px 15px; background: #000; height: 30%;}
        .start-btn {
            width: 100%; height: 45px; font-size: 1.1rem; font-weight: 900;
            color: white; background: linear-gradient(to bottom, #7ed321, #417505);
            border: 2px solid #b8e986; border-radius: 30px; cursor: pointer;
            box-shadow: 0 4px 0 #2e5a03;
        }

        .join-spectators-btn { background: transparent; border: 1.5px solid #fff; color: #fff; padding: 3px 12px; border-radius: 15px; font-size: 0.7rem; cursor: pointer; }

        /* --- Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Modals) --- */
        .modal-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; z-index: 100;
        }
        .settings-modal {
            width: 90%; max-height: 85%; background: var(--modal-bg); border-radius: 20px; padding: 20px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5); border: 1px solid #444; position: relative;
            overflow-y: auto;
        }
        .close-icon { position: absolute; top: 15px; left: 15px; cursor: pointer; font-size: 1.2rem; color: #888; z-index: 10; }
        .modal-header { font-size: 1rem; font-weight: bold; margin-bottom: 15px; text-align: center; text-transform: uppercase; }

        /* --- ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ (Accordion) --- */
        .rules-intro { font-size: 0.75rem; text-align: center; color: #ccc; margin-bottom: 20px; line-height: 1.4; }
        .accordion-item { margin-bottom: 8px; border-radius: 12px; overflow: hidden; }
        .accordion-header {
            background: var(--accordion-bg); padding: 12px 15px; display: flex; justify-content: space-between;
            align-items: center; cursor: pointer; transition: 0.3s; font-weight: bold; font-size: 0.85rem;
        }
        .accordion-header:hover { background: #333; }
        .accordion-header.active { background: var(--green-action); color: white; }
        .accordion-content {
            background: #1e1e1e; display: none; padding: 15px; font-size: 0.75rem; line-height: 1.6; color: #ddd;
            border: 1px solid #333; border-top: none; border-radius: 0 0 12px 12px;
        }
        .accordion-content ul { padding-right: 20px; margin: 0; }
        .accordion-content li { margin-bottom: 8px; }
        .accordion-header span:last-child {
            transition: transform 0.3s;
        }
        .accordion-header.active span:last-child {
            transform: rotate(180deg);
        }

        .log-row { display: flex; width: 100%; align-items: center; gap: 5px; }
        .row-blue { justify-content: flex-start; flex-direction: row-reverse; } 
        .row-red { justify-content: flex-start; flex-direction: row; } 

        .log-clue-item { display: flex; align-items: center; gap: 4px; border-radius: 5px; padding: 2px 4px; border: 1px solid rgba(255,255,255,0.2); width: 100%; }
        .log-clue-blue { background: #3498db; flex-direction: row-reverse; }
        .log-clue-red { background: #e74c3c; flex-direction: row; }
        
        .log-avatar { width: 30px; height: 30px; border-radius: 50%; border: 2px solid; }
        .log-text-clue { font-weight: bold; color: black; background: white; border-radius: 3px; padding: 1px 4px; width: 100%; text-align: center; font-size: 1rem;}
        .log-num-circle { width: 30px; height: 30px; background: white; border-radius: 50%; color: black; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1rem; flex-shrink: 0;}

        .log-guess-item { display: flex; align-items: center; gap: 4px; }
        .log-guess-text { padding: 1px 6px; border-radius: 4px; font-weight: bold; color: white; font-size: 0.55rem; }
        .bg-blue { background: #3498db; } .bg-red { background: #e74c3c; } .bg-brown { background: #d2b48c; } .bg-black { background: #000; color: white !important; }

        /* --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ù‚Øª (Slider) --- */
        .timer-display { text-align: center; margin-bottom: 20px; }
        .timer-icon { font-size: 2.5rem; display: block; margin-bottom: 5px; }
        .timer-status { font-size: 0.8rem; color: #fff; font-weight: bold; }
        .slider-container { width: 100%; padding: 10px 0; }
        .timer-slider {
            width: 100%; -webkit-appearance: none; appearance: none; background: #444;
            height: 4px; border-radius: 2px; outline: none;
        }
        .timer-slider::-webkit-slider-thumb {
            -webkit-appearance: none; width: 18px; height: 18px;
            background: #7ed321; border-radius: 50%; cursor: pointer; border: 2px solid white;
        }
        .slider-labels { display: flex; justify-content: space-between; margin-top: 10px; }
        .slider-labels span { font-size: 0.55rem; color: #888; }
        .slider-labels span.active-label { color: #7ed321; font-weight: bold; }

        /* --- Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ --- */
        .setting-item { margin-bottom: 20px; }
        .setting-item label { display: block; font-size: 0.8rem; color: #aaa; margin-bottom: 8px; }
        .nickname-input { width: 100%; background: #1a1a1a; border: 1px solid #444; color: white; padding: 10px; border-radius: 10px; font-size: 0.9rem; outline: none; }
        .avatar-selector { display: flex; gap: 10px; overflow-x: auto; padding: 5px; }
        .avatar-option { width: 50px; height: 50px; border-radius: 50%; border: 2px solid white; cursor: pointer; transition: 0.2s; flex-shrink: 0; }
        .avatar-option.selected { border-color: #7ed321; transform: scale(1.1); }
        .leave-btn { width: 100%; background: #c62828; color: white; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 0.9rem; }
        .close-modal-btn { width: 100%; background: #444; color: white; border: none; padding: 10px; border-radius: 12px; cursor: pointer; margin-top: 10px; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="mobile-wrapper">
        <div class="modal-overlay" id="profileModal">
        <div class="settings-modal">
            <div class="modal-header">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</div>
            <div class="setting-item">
                <label>Ø§Ù„Ù„Ù‚Ø¨ (Nickname)</label>
                <input type="text" id="nicknameInput" class="nickname-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§..." value="Player">
            </div>
            <div class="setting-item">
                <label>Ø§Ø®ØªØ± ØµÙˆØ±ØªÙƒ</label>
                <div class="avatar-selector">
                    <img src="img/avatar_snow_man.webp" class="avatar-option selected" onclick="selectAvatar(this)">
                    <img src="img/avatar_women.webp" class="avatar-option" onclick="selectAvatar(this)">
                    <img src="img/avatar_old_man.webp" class="avatar-option" onclick="selectAvatar(this)">
                    <img src="img/avatar_little_girl.webp" class="avatar-option" onclick="selectAvatar(this)">
                </div>
            </div>
            <button class="leave-btn" onclick="leaveMatch()">Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            <button class="close-modal-btn" onclick="toggleProfileModal(false)">Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>


    <div class="modal-overlay" id="rulesModal">
        <div class="settings-modal">
            <span class="close-icon" onclick="toggleRulesModal(false)">âœ•</span>
            <div class="modal-header">ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</div>
            <div class="rules-intro">
                ÙƒÙˆØ¯Ù†Ø§ÙŠÙ…Ø² Ù‡ÙŠ Ù„Ø¹Ø¨Ø© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø±Ø¨Ø· Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ Ø¨ÙŠÙ† ÙØ±ÙŠÙ‚ÙŠÙ†: <b>Ø§Ù„Ø£Ø²Ø±Ù‚</b> Ùˆ <b>Ø§Ù„Ø£Ø­Ù…Ø±</b>. ÙŠØ­Ø§ÙˆÙ„ ÙƒÙ„ ÙØ±ÙŠÙ‚ ØªØ®Ù…ÙŠÙ† ÙƒÙ„Ù…Ø§ØªÙ‡Ù… Ø§Ù„Ø³Ø±ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±.
            </div>

            <div id="rulesAccordion">
                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ® Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Ø±</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li>ÙŠÙ†Ù‚Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø¥Ù„Ù‰ ÙØ±ÙŠÙ‚ÙŠÙ†: <b>Ø§Ù„Ø£Ø²Ø±Ù‚</b> Ùˆ <b>Ø§Ù„Ø£Ø­Ù…Ø±</b>.</li>
                            <li>ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ ÙƒÙ„ ÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ <b>Ø¬Ø§Ø³ÙˆØ³ (Spymaster)</b> ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ùˆ<b>Ø¹Ù…ÙŠÙ„ (Operative)</b>.</li>
                            <li>ÙŠØªÙ… Ø¹Ø±Ø¶ Ø´Ø¨ÙƒØ© 5Ã—5 Ù…ÙƒÙˆÙ†Ø© Ù…Ù† 25 Ø¨Ø·Ø§Ù‚Ø© ÙƒÙˆØ¯Ù†Ø§ÙŠÙ…Ø² Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ•µï¸ Ù‚Ø§Ø¯Ø© Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li>ÙŠØ±Ù‰ Ø§Ù„Ù‚Ø§Ø¯Ø© Ù‡ÙˆÙŠØ§Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§ØªØŒ ÙˆÙ‡ÙŠ Ø³Ø±ÙŠØ© ØªÙ…Ø§Ù…Ø§Ù‹ Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡.</li>
                            <li>ÙŠØ¹Ø·ÙŠ Ø§Ù„Ù‚Ø§Ø¦Ø¯ ØªÙ„Ù…ÙŠØ­Ø§Ù‹ Ù…ÙƒÙˆÙ†Ø§Ù‹ Ù…Ù† <b>ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø©</b> Ùˆ <b>Ø±Ù‚Ù…</b> Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙØ±ÙŠÙ‚Ù‡.</li>
                        </ul>
                        <div class="log-row row-red">
                                <div class="log-clue-item log-clue-red">
                                <img src="img/avatar_snow_man.webp" id="rulesExampleAvatar" class="log-avatar" style="border-color:#fff">
                                <div class="log-text-clue">Ø­ÙŠÙˆØ§Ù†</div>
                                <div class="log-num-circle">3</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ™‹â€â™‚ï¸ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Operatives)</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li>Ù„Ø§ ÙŠØ¹Ø±Ù Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù‡ÙˆÙŠØ§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø³Ø¨Ù‚Ø§Ù‹.</li>
                            <li>ÙŠØ¹Ù…Ù„ÙˆÙ† Ù…Ø¹Ø§Ù‹ Ù„ØªØ®Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªÙ„Ù…ÙŠØ­ Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³.</li>
                            <li>ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙ‡Ù… ØªØ¬Ù†Ø¨ ÙƒÙ„Ù…Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø§ÙØ³ØŒ ÙˆØ¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø§ØºØªÙŠØ§Ù„.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸŸ¦ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <p>ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ ÙƒÙ„Ù…Ø© ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ© Ø³Ø±ÙŠØ§Ù‹ Ù„ÙˆØ§Ø­Ø¯ Ù…Ù† Ø£Ø±Ø¨Ø¹Ø© Ø£ØµÙ†Ø§Ù:</p>
                        <ul>
                            <li><b>Ø¨Ø·Ø§Ù‚Ø§Øª Ø²Ø±Ù‚Ø§Ø¡:</b> ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§.</li>
                            <li><b>Ø¨Ø·Ø§Ù‚Ø§Øª Ø­Ù…Ø±Ø§Ø¡:</b> ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§.</li>
                            <li><b>Ø§Ù„Ù…Ø§Ø±Ø© Ø§Ù„Ø£Ø¨Ø±ÙŠØ§Ø¡:</b> Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø­Ø§ÙŠØ¯Ø© ØªÙ†Ù‡ÙŠ Ø§Ù„Ø¯ÙˆØ± ÙÙ‚Ø·.</li>
                            <li><b>Ø§Ù„Ù…ØºØªØ§Ù„ (Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡):</b> Ø¥Ø°Ø§ Ù„Ù…Ø³ØªÙ‡Ø§ØŒ ÙŠØ®Ø³Ø± ÙØ±ÙŠÙ‚Ùƒ ÙÙˆØ±Ø§Ù‹!</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ’¬ Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <p>Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ£ØªÙŠ Ø¯ÙˆØ±Ùƒ ÙƒÙ‚Ø§Ø¦Ø¯ Ø¬Ø§Ø³ÙˆØ³:</p>
                        <ol>
                            <li>Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© ØªØ±Ø¨Ø· Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù…ÙƒÙ† Ù…Ù† Ø¨Ø·Ø§Ù‚Ø§Øª ÙØ±ÙŠÙ‚Ùƒ.</li>
                            <li>Ø£Ø¶Ù Ø±Ù‚Ù…Ø§Ù‹ ÙŠÙˆØ¶Ø­ Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„ØªÙ„Ù…ÙŠØ­.</li>
                            <li><b>ØªÙ†Ø¨ÙŠÙ‡:</b> Ù„Ø§ ÙŠØµØ­ Ø¥Ø¹Ø·Ø§Ø¡ ØªÙ„Ù…ÙŠØ­ Ù‡Ùˆ Ø¬Ø²Ø¡ Ù…Ù† ÙƒÙ„Ù…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ©!</li>
                        </ol>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ§  Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø§Ù„ØµØ§Ù„Ø­Ø©</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li>ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ¹Ù„Ù‚ Ø§Ù„ØªÙ„Ù…ÙŠØ­ <b>Ø¨Ù…Ø¹Ù†Ù‰</b> Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆÙ„ÙŠØ³ Ø¨Ø·Ø±ÙŠÙ‚Ø© ÙƒØªØ§Ø¨ØªÙ‡Ø§ Ø£Ùˆ Ù…ÙˆÙ‚Ø¹Ù‡Ø§.</li>
                            <li>Ù„Ø§ ÙŠØ¬ÙˆØ² Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ±Ø¬Ù…Ø§Øª Ù„Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ù„ØºØ§Øª Ø£Ø®Ø±Ù‰.</li>
                            <li>Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ØªØ£ÙƒØ¯Ø§Ù‹ Ù…Ù† Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„ØªÙ„Ù…ÙŠØ­ØŒ Ø§Ø³Ø£Ù„ Ø§Ù„Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ù…Ù†Ø§ÙØ³ Ø³Ø±ÙŠØ§Ù‹.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ•¹ï¸ Ø§Ù„ØªØ®Ù…ÙŠÙ† (Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡)</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <p>Ø¨Ø¹Ø¯ Ø³Ù…Ø§Ø¹ Ø§Ù„ØªÙ„Ù…ÙŠØ­ØŒ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ù€:</p>
                        <ol>
                            <li>Ù…Ù†Ø§Ù‚Ø´Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© ÙÙŠÙ…Ø§ Ø¨ÙŠÙ†Ù‡Ù….</li>
                            <li>ØªØ­Ø¯ÙŠØ¯ Ø§Ø®ØªÙŠØ§Ø±Ù‡Ù… Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø©.</li>
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ®Ù…ÙŠÙ† ØµØ­ÙŠØ­Ø§Ù‹ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø¨ØªØ®Ù…ÙŠÙ† ÙƒÙ„Ù…Ø© Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø°ÙƒÙˆØ± + 1).</li>
                        </ol>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ”¢ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø§Ù„Ø®Ø§ØµØ©</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li><b>Ø§Ù„ØªÙ„Ù…ÙŠØ­ 0:</b> ÙŠØ¹Ù†ÙŠ Ø£Ù† Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙŠ ÙƒÙ„Ù…Ø© Ù…Ù† ÙƒÙ„Ù…Ø§Øª ÙØ±ÙŠÙ‚Ùƒ ØªØ±ØªØ¨Ø· Ø¨Ø§Ù„ØªÙ„Ù…ÙŠØ­ (ÙŠÙØ³ØªØ®Ø¯Ù… Ù„Ø¥Ø¨Ø¹Ø§Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚ Ø¹Ù† Ø®Ø·Ø± Ø§Ù„Ù…ØºØªØ§Ù„).</li>
                            <li><b>Ø§Ù„ØªÙ„Ù…ÙŠØ­ Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠ (âˆ):</b> ÙŠØ³Ù…Ø­ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø§Ù„ØªØ®Ù…ÙŠÙ† Ø¨Ù„Ø§ Ø­Ø¯ÙˆØ¯ Ø­ØªÙ‰ ÙŠØ®Ø·Ø¦ÙˆØ§ Ø£Ùˆ ÙŠØªÙˆÙ‚ÙÙˆØ§.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ù„Ø¹Ø¨Ø©</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <p>ØªÙ†ØªÙ‡ÙŠ Ù†ÙˆØ¨Ø© Ø§Ù„ÙØ±ÙŠÙ‚ ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
                        <ul>
                            <li>Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø·Ø§Ù‚Ø© "Ù…Ø§Ø± Ø¨Ø±ÙŠØ¡" Ø£Ùˆ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ù†Ø§ÙØ³.</li>
                            <li>Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§.</li>
                            <li>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ØªÙˆÙ‚Ù Ø·ÙˆØ§Ø¹ÙŠØ©Ù‹ Ù„Ø¹Ø¯Ù… Ø§Ù„Ù…Ø®Ø§Ø·Ø±Ø©.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ¯ Ø§Ù„ÙÙˆØ² ÙˆØ§Ù„Ø®Ø³Ø§Ø±Ø©</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li><b>Ø§Ù„ÙÙˆØ²:</b> Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø°ÙŠ ÙŠÙ†Ø¬Ø­ ÙÙŠ ÙƒØ´Ù Ø¬Ù…ÙŠØ¹ Ø¨Ø·Ø§Ù‚Ø§ØªÙ‡ Ø£ÙˆÙ„Ø§Ù‹ Ù‡Ùˆ Ø§Ù„ÙØ§Ø¦Ø².</li>
                            <li><b>Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©:</b> Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø°ÙŠ ÙŠÙ„Ù…Ø³ Ø¨Ø·Ø§Ù‚Ø© "Ø§Ù„Ù…ØºØªØ§Ù„" Ø§Ù„Ø£Ø³ÙˆØ¯ ÙŠØ®Ø³Ø± Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙˆØ±Ø§Ù‹ Ù…Ù‡Ù…Ø§ ÙƒØ§Ù†Øª Ù†ØªÙŠØ¬ØªÙ‡.</li>
                        </ul>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <span>ğŸ¥³ Ù†ØµØ§Ø¦Ø­ Ø®ØªØ§Ù…ÙŠØ©</span>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content">
                        <ul>
                            <li>ÙƒÙˆØ¯Ù†Ø§ÙŠÙ…Ø² Ù„Ø¹Ø¨Ø© Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©Ø› Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø±ÙˆØ­ Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ù…Ù…ØªØ¹Ø©.</li>
                            <li>ÙƒÙ‚Ø§Ø¦Ø¯ Ø¬Ø§Ø³ÙˆØ³ØŒ Ø­Ø§ÙˆÙ„ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ "ÙˆØ¬Ù‡ Ø§Ù„Ø¨ÙˆÙƒØ±" ÙˆÙ„Ø§ ØªØ¹Ø·ÙŠ Ø£ÙŠ Ø¥Ø´Ø§Ø±Ø§Øª Ø¬Ø³Ø¯ÙŠØ©.</li>
                            <li>Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø±Ø¨Ø· Ø§Ù„Ø¹Ø¬ÙŠØ¨ Ø¨ÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª!</li>
                        </ul>
                    </div>
                </div>
                
            </div>

            <button class="close-modal-btn" onclick="toggleRulesModal(false)">ÙÙ‡Ù…Øª Ø°Ù„Ùƒ!</button>
        </div>
    </div>
    <div class="modal-overlay" id="timerModal">
        <div class="settings-modal">
            <span class="close-icon" onclick="toggleTimerModal(false)">âœ•</span>
            <div class="modal-header">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ù‚Øª</div>
            <div class="timer-display">
                <span class="timer-icon" id="modalTimerIcon">ğŸš«</span>
                <span class="timer-status" id="modalTimerText">Ø¨Ø¯ÙˆÙ† Ù…Ø¤Ù‚Øª</span>
            </div>
            <div class="slider-container">
                <input type="range" min="0" max="3" value="0" class="timer-slider" id="timerSlider" oninput="updateTimerValue(this.value)">
                <div class="slider-labels">
                    <span id="label0" class="active-label">Ø¨Ø¯ÙˆÙ†</span>
                    <span id="label1">Ø³Ø±ÙŠØ¹</span>
                    <span id="label2">Ù…ØªÙˆØ³Ø·</span>
                    <span id="label3">Ø¨Ø·ÙŠØ¡</span>
                </div>
            </div>
        </div>
    </div>

<div class="top-section">
    <div class="top-bar">
        <div class="top-left">
            <div class="icon-circle">
                <span style="font-size: 0.8rem; font-weight: bold; margin-left: 2px;">1</span> ğŸ‘¥
            </div>
        </div>

        <div class="top-right">
            <div class="btn-pill" onclick="toggleRulesModal(true)">ğŸ“ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</div>
            <div class="icon-circle" onclick="toggleProfileModal(true)">âš™ï¸</div>
        </div>
    </div>

        <div class="spectators-section">
            <div class="spectators-header">
                <span class="view-icon">ğŸ‘ï¸</span>
                <span class="box-title">Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±</span>
            </div>
            <div class="spectators-list" id="spectators-list">
                <div class="player-slot" id="main-player">
                    <div class="player-avatar-wrap">
                        <img src="img/avatar_snow_man.webp" id="currentAvatarImg" class="player-img">
                    </div>
                    <div class="player-name" id="currentPlayerName">Player</div>
                </div>
                <button class="join-spectators-btn" onclick="joinTeam(this, 'spectators-list')">Ø£Ù†Ø¶Ù…Ø§Ù…</button>
            </div>
        </div>

        <div class="settings-panel">
            <div class="panel-label">Ø£Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</div>
            <div class="mode-options">
                <div class="mode-card active" onclick="selectMode(this)">
                    <img src="img/local.webp" class="mode-img">
                    <div class="mode-info"><b>Ø§ÙˆÙÙ„Ø§ÙŠÙ†</b><span>4+ Ù„Ø§Ø¹Ø¨ÙŠÙ†</span></div>
                </div>
                <div class="mode-card" onclick="selectMode(this)">
                    <img src="img/online.webp" class="mode-img">
                    <div class="mode-info"><b>Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†</b><span>4+ Ù„Ø§Ø¹Ø¨ÙŠÙ†</span></div>
                </div>
            </div>
            <div class="setting-row" onclick="toggleTimerModal(true)">
                <span style="font-size: 1.2rem;" id="mainTimerIcon">ğŸš«</span>
                <div style="margin-right: 10px;">
                    <b style="font-size: 0.7rem; display: block;">Ø§Ù„Ù…Ø¤Ù‚Øª</b>
                    <span style="font-size: 0.55rem; color: #888;" id="mainTimerText">Ø¨Ø¯ÙˆÙ†</span>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-section">
        <div class="teams-grid">
            <div class="team-box blue-box">
                <div class="box-title">OPERATIVES</div>
                <div class="player-slot-container"></div>
                <button class="join-btn" onclick="joinTeam(this, 'blue-op')">Ø£Ù†Ø¶Ù…Ø§Ù…</button>
            </div>
            <div class="team-box red-box">
                <div class="box-title">OPERATIVES</div>
                <div class="player-slot-container"></div>
                <button class="join-btn" onclick="joinTeam(this, 'red-op')">Ø£Ù†Ø¶Ù…Ø§Ù…</button>
            </div>
            <div class="team-box blue-box">
                <div class="box-title">SPYMASTERS</div>
                <div class="player-slot-container"></div>
                <button class="join-btn" onclick="joinTeam(this, 'blue-spy')">Ø£Ù†Ø¶Ù…Ø§Ù…</button>
            </div>
            <div class="team-box red-box">
                <div class="box-title">SPYMASTERS</div>
                <div class="player-slot-container"></div>
                <button class="join-btn" onclick="joinTeam(this, 'red-spy')">Ø£Ù†Ø¶Ù…Ø§Ù…</button>
            </div>
        </div>
        <div class="footer">
            <button class="start-btn" onclick="goToIndex()">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        </div>
    </div>
</div>

<script>
// --- Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ ---
// function toggleProfileModal(show) {
//     const modal = document.getElementById('profileModal');
//     modal.style.display = show ? 'flex' : 'none';
//     if (!show) {
//         const newName = document.getElementById('nicknameInput').value;
//         if(newName.trim() !== "") document.getElementById('currentPlayerName').innerText = newName;
//     }
// }
function toggleProfileModal(show) {
    const modal = document.getElementById('profileModal');
    modal.style.display = show ? 'flex' : 'none';
    if (!show) {
        const newName = document.getElementById('nicknameInput').value;
        if(newName.trim() !== "") {
            document.getElementById('currentPlayerName').innerText = newName;
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¨Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            window.updatePlayerOnServer();
        }
    }
}

function selectAvatar(imgElement) {
    document.querySelectorAll('.avatar-option').forEach(img => img.classList.remove('selected'));
    imgElement.classList.add('selected');
    document.getElementById('currentAvatarImg').src = imgElement.src;
}

function leaveMatch() {
    if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ")) {
        window.location.reload(); 
    }
}

// --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ (Ø¬Ø¯ÙŠØ¯) ---
function toggleRulesModal(show) {
    document.getElementById('rulesModal').style.display = show ? 'flex' : 'none';
}

function toggleAccordion(header) {
    const content = header.nextElementSibling;
    const isVisible = content.style.display === 'block';
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙƒÙ„ Ø£ÙˆÙ„Ø§Ù‹
    document.querySelectorAll('.accordion-content').forEach(c => c.style.display = 'none');
    document.querySelectorAll('.accordion-header').forEach(h => h.classList.remove('active'));
    
    // ÙØªØ­ Ø§Ù„Ù…Ø®ØªØ§Ø± ÙÙ‚Ø·
    if (!isVisible) {
        content.style.display = 'block';
        header.classList.add('active');
    }
}

// --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ù‚Øª ---
const timerConfigs = [
    { label: "Ø¨Ø¯ÙˆÙ† Ù…Ø¤Ù‚Øª", main: "Ø¨Ø¯ÙˆÙ†", icon: "ğŸš«", color: "#888" },
    { label: "Ø³Ø±ÙŠØ¹ (30 Ø«Ø§Ù†ÙŠØ©)", main: "30 Ø«Ø§Ù†ÙŠØ©", icon: "âš¡", color: "#7ed321" },
    { label: "Ù…ØªÙˆØ³Ø· (Ø¯Ù‚ÙŠÙ‚Ø©)", main: "1 Ø¯Ù‚ÙŠÙ‚Ø©", icon: "â±ï¸", color: "#f5a623" },
    { label: "Ø¨Ø·ÙŠØ¡ (Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†)", main: "2 Ø¯Ù‚ÙŠÙ‚Ø©", icon: "ğŸ¢", color: "#4a90e2" }
];

function toggleTimerModal(show) {
    document.getElementById('timerModal').style.display = show ? 'flex' : 'none';
}

function updateTimerValue(val) {
    const config = timerConfigs[val];
    document.getElementById('modalTimerText').innerText = config.label;
    document.getElementById('modalTimerIcon').innerText = config.icon;
    document.getElementById('mainTimerText').innerText = config.main;
    document.getElementById('mainTimerIcon').innerText = config.icon;
    for(let i=0; i<=3; i++) {
        document.getElementById('label'+i).classList.remove('active-label');
    }
    document.getElementById('label'+val).classList.add('active-label');
}


// --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ---
function selectMode(element) {
    document.querySelectorAll('.mode-card').forEach(card => card.classList.remove('active'));
    element.classList.add('active');
}
function joinTeam(clickedBtn, teamId) {
    // Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙŠØ¯ÙˆÙŠØ§Ù‹ØŒ Ù†Ø­Ø¯Ø« Ø§Ù„Ø³ÙŠØ±ÙØ± ÙˆØ§Ù„Ø³ÙŠØ±ÙØ± Ø³ÙŠÙ‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ù…ÙŠØ¹
    if(window.updatePlayerOnServer) {
        window.updatePlayerOnServer(teamId);
    }
}
// function joinTeam(clickedBtn, teamId) {
//     const playerElement = document.getElementById('main-player');
//     resetAllButtons();
//     clickedBtn.innerText = "Ù…Ù†Ø¶Ù…";
//     clickedBtn.style.background = "transparent";
//     clickedBtn.style.border = "1.5px solid #fff";
//     clickedBtn.style.boxShadow = "none";

//     if (teamId === 'spectators-list') {
//         document.getElementById('spectators-list').insertBefore(playerElement, clickedBtn);
//         clickedBtn.innerText = "Ø£Ù†Ø¶Ù…Ø§Ù…";
//     } else {
//         clickedBtn.previousElementSibling.appendChild(playerElement);
//     }
// }

function resetAllButtons() {
    document.querySelectorAll('.join-btn').forEach(btn => {
        btn.innerText = "Ø£Ù†Ø¶Ù…Ø§Ù…";
        btn.style.background = "linear-gradient(to bottom, #7ed321, #417505)";
        btn.style.border = "1.5px solid #b8e986";
        btn.style.boxShadow = "0 2px 0 #2e5a03";
    });
    const specBtn = document.querySelector('.join-spectators-btn');
    specBtn.innerText = "Ø£Ù†Ø¶Ù…Ø§Ù…";
    specBtn.style.border = "1.5px solid #fff";
}

function goToIndex() { window.location.href = "game.html"; }
</script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getDatabase, ref, set, onValue, push, onDisconnect } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC95r_D7FVO-cynZ-gK6zbldvvrY4HD2YQ",
    authDomain: "codenames-5fd71.firebaseapp.com",
    projectId: "codenames-5fd71",
    storageBucket: "codenames-5fd71.firebasestorage.app",
    messagingSenderId: "57751572026",
    appId: "1:57751572026:web:907eb7d57c61eb00d5af03",
    measurementId: "G-BGXGT364NM"
  };

  // 1. ØªØ´ØºÙŠÙ„ Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // 2. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø§Ø¨Ø· (Ø§Ù„Ø±Ø¯Ù‡Ø©)
  let urlParams = new URLSearchParams(window.location.search);
  let roomId = urlParams.get('r');

  if (!roomId) {
      // Ø¥Ø°Ø§ Ø¯Ø®Ù„ Ø§Ù„Ø´Ø®Øµ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¯ÙˆÙ† ÙƒÙˆØ¯ Ø±Ø¯Ù‡Ø©ØŒ Ù†ØµÙ†Ø¹ Ù„Ù‡ ÙƒÙˆØ¯ Ø¬Ø¯ÙŠØ¯
      roomId = Math.random().toString(36).substring(2, 8);
      window.history.pushState({}, '', '?r=' + roomId);
  }

  // 3. Ù‡ÙˆÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ (ØªØ®Ø²Ù† ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ù„ÙƒÙŠ Ù„Ø§ ØªØªØºÙŠØ± Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©)
  let playerId = localStorage.getItem('codenames_playerId') || Math.random().toString(36).substring(2, 6);
  localStorage.setItem('codenames_playerId', playerId);

  // Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  const roomRef = ref(db, 'rooms/' + roomId);
  const playersRef = ref(db, 'rooms/' + roomId + '/players');
  const myPlayerRef = ref(db, 'rooms/' + roomId + '/players/' + playerId);

  // 4. ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§ØªÙŠ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±
  window.updatePlayerOnServer = function(teamRole = 'spectators-list') {
      const name = document.getElementById('currentPlayerName').innerText;
      const avatar = document.getElementById('currentAvatarImg').getAttribute('src');
      
      set(myPlayerRef, {
          id: playerId,
          name: name,
          avatar: avatar,
          team: teamRole,
          lastActive: Date.now()
      });
  };

  // Ø­Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ØªØµÙØ­ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  onDisconnect(myPlayerRef).remove();

  // 5. Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø£ÙŠ ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø±Ø¯Ù‡Ø© (Ø¹Ù†Ø¯ Ø¯Ø®ÙˆÙ„ Ø£ÙŠ Ù„Ø§Ø¹Ø¨ Ø£Ùˆ ØªØºÙŠÙŠØ± ÙØ±ÙŠÙ‚Ù‡)
  onValue(playersRef, (snapshot) => {
      const players = snapshot.val();
      if (!players) return;

      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ù‚Ø¨Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±Ø³Ù…
      document.querySelectorAll('.player-slot-container').forEach(c => c.innerHTML = '');
      document.getElementById('spectators-list').querySelectorAll('.player-slot').forEach(p => p.remove());

      // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ÙØ±Ù‚ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
      Object.values(players).forEach(player => {
          const playerHtml = `
            <div class="player-slot" id="player-${player.id}">
                <div class="player-avatar-wrap">
                    <img src="${player.avatar}" class="player-img">
                </div>
                <div class="player-name">${player.name}</div>
            </div>`;

          if (player.team === 'spectators-list') {
              const list = document.getElementById('spectators-list');
              list.insertAdjacentHTML('afterbegin', playerHtml);
          } else {
              // Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù€ teamId
              // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‚Ù…Øª Ø¨Ø±Ø¨Ø·Ù‡Ø§ Ø¨Ù€ previousElementSibling Ù„Ù„Ø²Ø± ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ
              const containers = {
                  'blue-op': 0, 'red-op': 1, 'blue-spy': 2, 'red-spy': 3
              };
              const index = containers[player.team];
              if (index !== undefined) {
                  document.querySelectorAll('.player-slot-container')[index].innerHTML = playerHtml;
              }
          }
      });
  });

  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£ÙˆÙ„
  window.updatePlayerOnServer();

</script>
</body>
</html>